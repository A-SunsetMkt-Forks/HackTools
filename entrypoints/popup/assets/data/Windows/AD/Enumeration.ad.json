[{
        "id": 1,
        "topic": "Network enumeration",
        "commands": [{
            "id": "1.1",
            "title": "General network traffic inspection",
            "description": "Packet inspection can yield crucial data about the network, including IP ranges and network devices through broadcast messages",
            "linux": "sudo tcpdump -i {INTERFACE} -w output.pcap",
            "linux_description": "tcpdump can be used to intercpt network trafic, the ouput can later be analyzed with wireshark",
            "windows": "pktmon start --etw -p 0 ; pktmon stop; pktmon pcapng PktMon.etl -o output.pcapng",
            "windows_description": "pktmon is a tool that can be utilized to intercept network traffic. The resulting pcap file can later be analyzed using Wireshark."
        }]
    },
    {
        "id": 2,
        "topic": "Unauthenticated domain enumeration",
        "commands": [{
                "id": "2.1",
                "title": "NBT-NS/LLMNR/MDNS traffic inspection",
                "description": "Inspecting the traffic, can give you  valuable information such as the domain name and user account",
                "linux": "sudo responder -I ens224 -A",
                "linux_description": "In Linux you can use Responder to intercept the global interception",
                "windows": "Watch-Inveigh",
                "windows_description": "win desc"
            },
            {
                "id": "2.2",
                "title": "Kerberos Pre-Auth Bruteforcing to identify valid username",
                "description": "You can use KRB-PRE-AUTH queries against the DC to get a response on weither the account is valid or not (using a vvalid account can lock out the account based on domain password policy)",
                "linux": "kerbrute userenum -d {DOMAIN} --dc {DC_IP} {WORDLIST} -o kerbrute.{DOMAIN}.lst",
                "linux_description": "",
                "windows": "kerbrute userenum -d {DOMAIN} --dc {DC_IP} {WORDLIST} -o kerbrute.{DOMAIN}.lst",
                "windows_description": ""
            }
        ]
    },

    {
        "id": 3,
        "topic": "Authenticated domain enumeration",
        "commands": [{
                "id": "3.0",
                "title": "General domain enumeration",
                "description": "If time is not a constraint and you are not concerned about being detected, you can enumerate all information of the domain using several multipurpose enumeration tool.",
                "linux": "ldeep ldap -u {USER} -p {PASSWORD} -s ldap://{DC_IP} auth_policies;enum4linux-ng -P {DC_IP} -oA {DOMAIN}.e4l.txt",
                "linux_description": "You can either use the excellent ldeep tool, enum4linux-ng",
                "windows": "TODO",
                "windows_description": ""
            },
            {
                "id": "3.1",
                "title": "Domain password policies",
                "description": "Obtaining the domain's password policy is crucial to tailor your attack strategy and avoid account lockouts during the engagement",
                "linux": "ldeep ldap -u {USER} -p {PASSWORD} -s ldap://{DC_IP} auth_policies; cme smb {IP} -d {DOMAIN} -u {USER} -p {PASSWORD} --pass-pol;rpcclient -U \"{USERNAME}%{PASSWORD}\" -N {DC_IP}; (rpcclient)$> querydominfo",
                "linux_description": "You have the option to use either cme or rpcclient. Certain misconfigurations or legacy systems may allow you to use null sessions on SMB or RPC.",
                "windows": "TODO",
                "windows_description": ""
            },
            {
                "id": "3.2",
                "title": "Domain users",
                "description": "Enumerating domain users is a crucial step for lateral movement in a domain. The enumerated users can be used later for password spraying attacks.",
                "linux": "rpcclient -U \"{USERNAME}%{PASSWORD}\" -N {DC_IP}; $> enumdomusers",
                "linux_description": "rpcclient can be used to enumerate users via RPC",
                "windows": "TODO",
                "windows_description": "win desc"
            }
        ]
    }
]